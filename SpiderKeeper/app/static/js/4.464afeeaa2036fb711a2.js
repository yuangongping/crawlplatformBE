webpackJsonp([4],{ARoL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Xxa5"),o=n.n(a),i=n("exGp"),l=n.n(i),r=n("v/oH"),s={name:"dashboard",data:function(){return{list:null,listLoading:!0,log:[],dialogVisible:!1,pageIndex:1,pageSzie:12,total_num:null}},created:function(){this.fetchData()},methods:{handleCurrentChange:function(e){this.pageIndex=e,this.fetchData()},fetchData:function(){var e=this;this.listLoading=!0,Object(r.d)(this.pageIndex,this.pageSzie).then(function(t){e.list=t.data.data,e.total_num=t.data.total_num,e.listLoading=!1})},cancelspider:function(e,t,n){var a=this;return l()(o.a.mark(function i(){return o.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,a.loading=!0,o.next=4,Object(r.b)(e,t,n);case 4:a.loading=!1,o.next=10;break;case 7:o.prev=7,o.t0=o.catch(0),a.$message.error("取消爬虫错误 "+o.t0);case 10:case"end":return o.stop()}},i,a,[[0,7]])}))()},runOnce:function(e,t){var n=this;this.listLoading=!0,Object(r.g)(e,t).then(function(e){"success"===e.status?n.fetchData():(n.listLoading=!1,alert("Error"))})},viewMasterLog:function(e,t){var n=this;this.dialogVisible=!0,this.log=[],Object(r.e)(e,t).then(function(e){n.log=e.log})},viewSlaveLog:function(e,t){var n=this;this.dialogVisible=!0,this.log=[],Object(r.f)(e,t).then(function(e){n.log=e.log})}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{label:"序号",width:"65",type:"index",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{label:"项目名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.project_name)+" "+e._s(t.row.project_alias)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"蜘蛛名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.spider_name)+" "+e._s(t.row.spider_alias)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"项目类型",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.is_msd?n("span",[e._v("分布式")]):n("span",[e._v("单机")])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"主题分类",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.project_cate))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"最近运行时间",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.last_run_time))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"运行状态",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",[e._v(e._s(t.row.last_run_status))]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(t.row.last_run_status))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"日志",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.is_msd&&null!==t.row.job_exec_id?n("el-button",{attrs:{size:"mini"},on:{click:function(n){e.viewMasterLog(t.row.project_id,t.row.job_exec_id)}}},[e._v("  log ")]):e._e(),e._v(" "),"1"==t.row.is_msd&&null!==t.row.job_exec_id?n("el-button",{attrs:{size:"mini"},on:{click:function(n){e.viewMasterLog(t.row.project_id,t.row.job_exec_id)}}},[e._v("主log")]):e._e(),e._v(" "),"1"==t.row.is_msd&&null!==t.row.job_exec_id?n("el-button",{attrs:{size:"mini"},on:{click:function(n){e.viewSlaveLog(t.row.project_id,t.row.job_exec_id)}}},[e._v("从log")]):e._e()]}}])})],1),e._v(" "),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","page-size":12,total:e.total_num},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},e._l(e.log,function(t){return n("p",{key:t,staticClass:"dispalyLog"},[e._v(e._s(t))])}))],1)},staticRenderFns:[]};var u=n("VU/8")(s,c,!1,function(e){n("PR8P")},"data-v-5c3724b3",null);t.default=u.exports},Omly:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n.pagination[data-v-5c3724b3] {\n  margin-top: 50px;\n}\n.dispalyLog[data-v-5c3724b3] {\n  word-wrap: break-word;\n  word-break: break-all;\n  overflow: hidden;\n}\n",""])},PR8P:function(e,t,n){var a=n("Omly");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("0da3b038",a,!0)},"v/oH":function(e,t,n){"use strict";t.d=function(e,t){return Object(i.a)({url:"/allspider",method:"get",params:{pageIndex:e,pageSize:t}})},t.a=function(e){return e.selectedmonths=0==e.selectedmonths.length?null:e.selectedmonths.join(","),e.selecteddays=0==e.selecteddays.join(",").length?null:e.selecteddays.join(","),e.selectedhours=0==e.selectedhours.join(",").length?null:e.selectedhours.join(","),e.selectedminutes=0==e.selectedminutes.join(",").length?null:e.selectedminutes.join(","),Object(i.a)({url:"/addscheduler",method:"post",data:l.stringify(e)})},t.c=function(e){return Object(i.a)({url:"/delscheduler",method:"get",params:{job_instance_id:e}})},t.g=function(e,t){return Object(i.a)({url:"/runonce",method:"post",data:l.stringify({project_id:e,spider_name:t,spider_arguments:"",daemon:"auto",priority:0})})},t.b=function(e,t,n){return new o.a(function(a,o){Object(i.a)({url:"/cancelspider",method:"post",data:l.stringify({project_id:e,project_name:t,job_instance_id:n})}).then(function(e){a(e)}).catch(function(e){o(e)})})},t.e=function(e,t){return Object(i.a)({url:"/masterlog",method:"get",params:{project_id:e,job_exec_id:t}})},t.f=function(e,t){return Object(i.a)({url:"/slavelog",method:"get",params:{project_id:e,job_exec_id:t}})};var a=n("//Fk"),o=n.n(a),i=n("vLgD"),l=n("1nuA")}});
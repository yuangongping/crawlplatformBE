webpackJsonp([7],{"42kq":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Xxa5"),r=a.n(i),n=a("exGp"),s=a.n(n),o=a("//Fk"),l=a.n(o),c=a("vLgD"),u=a("1nuA");function m(e){return new l.a(function(t,a){Object(c.a)({url:"addmachine",method:"post",data:u.stringify({server_ip:e.server_ip,server_status:e.server_status,is_master:e.is_master})}).then(function(e){t(e)}).catch(function(e){a(e)})})}function d(e){return new l.a(function(t,a){Object(c.a)({url:"delmachine",method:"get",params:{id:e}}).then(function(e){t(e)}).catch(function(e){a(e)})})}function v(e){return new l.a(function(t,a){Object(c.a)({url:"editmachine",method:"post",data:u.stringify(e)}).then(function(e){t(e)}).catch(function(e){a(e)})})}var p={data:function(){return{list:[],editmachineForm:{},editmachineFormSubmit:{},machineForm:{server_ip:null,server_status:"1",is_master:0},machineRules:{server_ip:[{required:!0,message:"请输入服务器地址！",trigger:"blur"}]},editmachineRules:{server_ip:[{required:!0,message:"请输入服务器地址！",trigger:"blur"}]},loading:!1,listLoading:!1,dialogFormVisible:!1,dialogVisible:!1}},created:function(){this.listMachine()},methods:{listMachine:function(){var e=this;return s()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.prev=1,t.next=4,new l.a(function(e,t){Object(c.a)({url:"listmachine",method:"get"}).then(function(t){e(t)}).catch(function(e){t(e)})});case 4:a=t.sent,e.list=a.data,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e.$message.error("服务器列表获取错误 "+t.t0);case 11:e.listLoading=!1;case 12:case"end":return t.stop()}},t,e,[[1,8]])}))()},addMachine:function(){var e,t=this;this.$refs.machineForm.validate((e=s()(r.a.mark(function e(a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=15;break}return t.loading=!0,e.prev=2,e.next=5,m(t.machineForm);case 5:200===e.sent.code?(t.loading=!1,t.dialogFormVisible=!1,t.listMachine()):(t.loading=!1,t.dialogFormVisible=!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),t.loading=!1,t.dialogFormVisible=!1;case 13:e.next=16;break;case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,t,[[2,9]])})),function(t){return e.apply(this,arguments)}))},editMachine:function(){var e=this;return s()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.prev=1,t.next=4,v(e.editmachineForm);case 4:e.listMachine(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.log();case 10:e.listLoading=!1,e.dialogVisible=!1;case 12:case"end":return t.stop()}},t,e,[[1,7]])}))()},delMachine:function(e){var t=this;return s()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.listLoading=!1,a.prev=1,a.next=4,t.$confirm("此操作将永久删除该选项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(){t.$message.error("已取消操作！ ")});case 4:if("confirm"!==a.sent){a.next=11;break}return a.next=8,d(e);case 8:t.listMachine(),a.next=12;break;case 11:t.$message.log("已取消操作!");case 12:a.next=17;break;case 14:a.prev=14,a.t0=a.catch(1),t.$message.error("服务器删除错误 "+a.t0);case 17:case"end":return a.stop()}},a,t,[[1,14]])}))()}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.loading",value:!1,expression:"false",modifiers:{loading:!0}}],staticClass:"app-container",attrs:{"element-loading-text":"添加服务器中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"服务器ip"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.server_ip)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"服务器类型",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==Number(t.row.is_master)?a("span",[e._v("\n          主服务器\n        ")]):a("span",[e._v("\n          从服务器\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态",width:"155"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==Number(t.row.server_status)?a("span",{staticStyle:{"font-weight":"700"}},[e._v("\n          可用\n        ")]):a("span",{staticStyle:{color:"#999999"}},[e._v("\n          不可用\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.editmachineForm=JSON.parse(JSON.stringify(t.row)),e.editmachineFormSubmit=JSON.parse(JSON.stringify(t.row)),e.dialogVisible=!0}}},[e._v("\n          编辑\n        ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.delMachine(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-button",{attrs:{id:"add_server",type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加服务器")]),e._v(" "),a("el-dialog",{attrs:{title:"添加服务器",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"machineForm",attrs:{model:e.machineForm,rules:e.machineRules}},[a("el-form-item",{attrs:{label:"服务器ip","label-width":"200",prop:"server_ip"}},[a("el-input",{attrs:{name:"server_ip","auto-complete":"off",placeholder:"格式: http://172.10.10.183:6800"},model:{value:e.machineForm.server_ip,callback:function(t){e.$set(e.machineForm,"server_ip",t)},expression:"machineForm.server_ip"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务器状态","label-width":"200"}},[a("el-input",{attrs:{name:"server_status","auto-complete":"off",disabled:!0},model:{value:e.machineForm.server_status,callback:function(t){e.$set(e.machineForm,"server_status",t)},expression:"machineForm.server_status"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否为主服务器","label-width":"200"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.machineForm.is_master,expression:"machineForm.is_master"}],attrs:{name:"is_master"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.machineForm,"is_master",t.target.multiple?a:a[0])}}},[a("option",{attrs:{label:"是",value:"1"}},[e._v("是")]),e._v(" "),a("option",{attrs:{label:"否",value:"0",selected:"selected"}},[e._v("否")])])])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addMachine}},[e._v("添加")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑服务器",visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"editmachineForm",attrs:{model:e.editmachineForm,rules:e.editmachineRules}},[a("el-form-item",{attrs:{label:"服务器ip","label-width":"200",prop:"server_ip"}},[a("el-input",{attrs:{name:"server_ip","auto-complete":"off",placeholder:"格式: http://172.10.10.183:6800"},model:{value:e.editmachineForm.server_ip,callback:function(t){e.$set(e.editmachineForm,"server_ip",t)},expression:"editmachineForm.server_ip"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务器状态","label-width":"200"}},[a("el-input",{attrs:{name:"server_status","auto-complete":"off",disabled:!0},model:{value:e.editmachineForm.server_status,callback:function(t){e.$set(e.editmachineForm,"server_status",t)},expression:"editmachineForm.server_status"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否为主服务器","label-width":"200"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.editmachineForm.is_master,expression:"editmachineForm.is_master"}],attrs:{name:"is_master"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.editmachineForm,"is_master",t.target.multiple?a:a[0])}}},[a("option",{attrs:{label:"是",value:"1"}},[e._v("是")]),e._v(" "),a("option",{attrs:{label:"否",value:"0",selected:"selected"}},[e._v("否")])])])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.editMachine}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(p,f,!1,function(e){a("hP+i")},null,null);t.default=h.exports},CM4V:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n#add_server {\n  margin-top: 20px;\n}\n",""])},"hP+i":function(e,t,a){var i=a("CM4V");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("6e7a0dc2",i,!0)}});
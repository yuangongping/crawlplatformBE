webpackJsonp([2],{"5KrN":function(e,r,t){(e.exports=t("FZ+f")(!1)).push([e.i,"\n.line[data-v-768decec]{\r\n  text-align: center;\n}\r\n\r\n",""])},BO1k:function(e,r,t){e.exports={default:t("fxRn"),__esModule:!0}},"R+/v":function(e,r,t){var a=t("p6DB");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);t("rjj0")("237a63bd",a,!0)},VeOc:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t("Xxa5"),o=t.n(a),l=t("exGp"),n=t.n(l),i=t("BO1k"),s=t.n(i),p=t("//Fk"),c=t.n(p),d=t("mtWM"),m=t.n(d),f=t("zL8q"),u=t("IcnI"),g=m.a.create({baseURL:"http://172.16.119.6:5000",timeout:15e3,headers:{"Content-Type":"multipart/form-data"}});g.interceptors.response.use(function(e){var r=e.data;return 200!==r.code?(Object(f.Message)({message:"服务器响应错误: "+r.msg,type:"error",duration:5e3}),50008!==r.code&&50012!==r.code&&50014!==r.code||f.MessageBox.confirm("你已被登出，可以取消继续留在该页面，或者重新登录","确定登出",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then(function(){u.a.dispatch("FedLogOut").then(function(){location.reload()})}),c.a.reject(r.msg)):e.data},function(e){return e.msg?Object(f.Message)({message:e.msg,type:"error",duration:5e3}):Object(f.Message)({message:e,type:"error",duration:5e3}),c.a.reject(e)});var _=g,v=t("ICYs"),h={data:function(){return{fileList:[],developer_list:[],project_type:["开放平台","公文公告","餐饮","舆情","其他"],form:{project_name:null,project_alias:null,for_project:null,applicant:null,pro_type:1,is_msd:1,developers:[],eggFile:null,masterEggFile:null,slaveEggFile:null},formRules:{project_name:[{required:!0,message:"请输入项目英文名！",trigger:"blur"},{pattern:/^[A-Za-z0-9_]+$/,message:"不允许输入空格等特殊符号"}],project_alias:[{required:!0,message:"请输入项目中文名！",trigger:"blur"}],for_project:[{required:!0,message:"请输入服务项目字段信息！",trigger:"blur"}],applicant:[{required:!0,message:"请输入项目申请者字段信息！",trigger:"blur"}],developers:[{required:!0,message:"请输入项目开发者字段信息！",trigger:"blur"}],masterEggFile:[{required:!0,message:"请输入项目主爬虫文件！",trigger:"change"}],slaveEggFile:[{required:!0,message:"请输入项目从爬虫文件！",trigger:"change"}],eggFile:[{required:!0,message:"请输入项目爬虫文件！",trigger:"change"}]},loading:!1}},created:function(){this.listDevelopers()},methods:{exceedFile:function(e,r){this.$message.error("文件数量过多！")},fileChange1:function(e,r){var t=!1,a=!0,o=!1,l=void 0;try{for(var n,i=s()(r);!(a=(n=i.next()).done);a=!0){n.value.name===e.raw.name&&(t=!0)}}catch(e){o=!0,l=e}finally{try{!a&&i.return&&i.return()}finally{if(o)throw l}}t||r.push({name:e.raw.name}),this.form.eggFile=e.raw},fileChange2:function(e,r){var t=!1,a=!0,o=!1,l=void 0;try{for(var n,i=s()(r);!(a=(n=i.next()).done);a=!0){n.value.name===e.raw.name&&(t=!0)}}catch(e){o=!0,l=e}finally{try{!a&&i.return&&i.return()}finally{if(o)throw l}}t||r.push({name:e.raw.name}),this.form.masterEggFile=e.raw},fileChange3:function(e,r){var t=!1,a=!0,o=!1,l=void 0;try{for(var n,i=s()(r);!(a=(n=i.next()).done);a=!0){n.value.name===e.raw.name&&(t=!0)}}catch(e){o=!0,l=e}finally{try{!a&&i.return&&i.return()}finally{if(o)throw l}}t||r.push({name:e.raw.name}),this.form.slaveEggFile=e.raw},listDevelopers:function(){var e=this;return n()(o.a.mark(function r(){var t,a,l;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(v.d)();case 3:for(t=r.sent,a=[],l=0;l<t.data.length;l++)"0"===t.data[l].developer_status&&a.push(t.data[l].developer_name);e.developer_list=a,r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),e.$message.error("开发人员列表获取错误 "+r.t0);case 12:case"end":return r.stop()}},r,e,[[0,9]])}))()},addProject:function(e){var r=this;e.preventDefault(),this.$refs.form.validate(function(e){if(!e)return console.log("err submit"),!1;var t=new FormData;if(0===r.form.is_msd){if(!r.form.eggFile)return r.$message.error("请添加egg文件! "),!1;r.loading=!0,t.append("is_msd",r.form.is_msd),t.append("project_name",r.form.project_name),t.append("project_alias",r.form.project_alias),t.append("for_project",r.form.for_project),t.append("applicant",r.form.applicant),t.append("pro_type",r.project_type[r.form.pro_type]),t.append("developers",r.form.developers.join(",")),t.append("egg",r.form.eggFile);var a=r;_.post("/addproject",t).then(function(e){a.loading=!1,"success"===e.status&&a.$router.push({path:"/project/all"})}).catch(function(e){a.loading=!1,console.log(e)})}else{if(!r.form.masterEggFile)return r.$message.error("请添加主egg文件! "),!1;if(!r.form.slaveEggFile)return r.$message.error("请添加从egg文件! "),!1;r.loading=!0,t.append("is_msd",r.form.is_msd),t.append("project_name",r.form.project_name),t.append("project_alias",r.form.project_alias),t.append("for_project",r.form.for_project),t.append("applicant",r.form.applicant),t.append("pro_type",r.project_type[r.form.pro_type]),t.append("developers",r.form.developers.join(",")),t.append("master_egg",r.form.masterEggFile),t.append("slave_egg",r.form.slaveEggFile),a=r,_.post("/addproject",t).then(function(e){a.loading=!1,"success"===e.status&&a.$router.push({path:"/project/all"})}).catch(function(e){a.loading=!1,console.log(e)})}})}}},b={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"app-container",attrs:{"element-loading-text":"上传项目中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"150px","label-position":"left"}},[t("el-form-item",{attrs:{label:"项目英文名称",prop:"project_name"}},[t("el-input",{model:{value:e.form.project_name,callback:function(r){e.$set(e.form,"project_name",r)},expression:"form.project_name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"项目中文名称",prop:"project_alias"}},[t("el-input",{model:{value:e.form.project_alias,callback:function(r){e.$set(e.form,"project_alias",r)},expression:"form.project_alias"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"服务项目",prop:"for_project"}},[t("el-input",{model:{value:e.form.for_project,callback:function(r){e.$set(e.form,"for_project",r)},expression:"form.for_project"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"项目申请者",prop:"applicant"}},[t("el-input",{model:{value:e.form.applicant,callback:function(r){e.$set(e.form,"applicant",r)},expression:"form.applicant"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"项目开发者",prop:"developers"}},[t("el-checkbox-group",{model:{value:e.form.developers,callback:function(r){e.$set(e.form,"developers",r)},expression:"form.developers"}},e._l(this.developer_list,function(e){return t("el-checkbox",{key:e,attrs:{label:e,name:e}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"项目类型",prop:"pro_type"}},[t("el-radio-group",{model:{value:e.form.pro_type,callback:function(r){e.$set(e.form,"pro_type",r)},expression:"form.pro_type"}},[t("el-radio",{attrs:{label:0}},[e._v(e._s(this.project_type[0]))]),e._v(" "),t("el-radio",{attrs:{label:1}},[e._v(e._s(this.project_type[1]))]),e._v(" "),t("el-radio",{attrs:{label:2}},[e._v(e._s(this.project_type[2]))]),e._v(" "),t("el-radio",{attrs:{label:3}},[e._v(e._s(this.project_type[3]))]),e._v(" "),t("el-radio",{attrs:{label:4}},[e._v(e._s(this.project_type[4]))])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"蜘蛛类型",prop:"is_msd"}},[t("el-radio-group",{model:{value:e.form.is_msd,callback:function(r){e.$set(e.form,"is_msd",r)},expression:"form.is_msd"}},[t("el-radio",{attrs:{label:1}},[e._v("分布式")]),e._v(" "),t("el-radio",{attrs:{label:0}},[e._v("单机")])],1)],1),e._v(" "),"0"==e.form.is_msd?t("el-form-item",{attrs:{label:"爬虫文件包","label-width":"200px"}},[t("el-upload",{attrs:{action:"#",accept:".egg","on-exceed":e.exceedFile,"on-change":e.fileChange1,"file-list":e.fileList,limit:1,multiple:"",drag:""}},[t("i",{staticClass:"el-icon-upload"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),t("em",[e._v("点击上传")])])])],1):e._e(),e._v(" "),"1"==e.form.is_msd?t("el-form-item",{attrs:{label:"爬虫文件包","label-width":"200px"}},[t("el-row",[t("el-col",{attrs:{span:4}},[t("el-upload",{attrs:{action:"#",accept:".egg","on-exceed":e.exceedFile,"on-change":e.fileChange2,"file-list":e.fileList,limit:1,multiple:"",drag:""}},[t("i",{staticClass:"el-icon-upload"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[t("em",[e._v("主爬虫")]),e._v("  文件上传处")])])],1),e._v(" "),t("el-col",{attrs:{span:4}},[t("el-upload",{attrs:{action:"#",accept:".egg","on-exceed":e.exceedFile,"on-change":e.fileChange3,"file-list":e.fileList,limit:1,multiple:"",drag:""}},[t("i",{staticClass:"el-icon-upload"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[t("em",[e._v("从爬虫")]),e._v("  文件上传处")])])],1)],1)],1):e._e(),e._v(" "),t("el-form-item",[t("p",[e._v("Tips: 项目打包命令 ( scrapyd-deploy -p 项目名称 --build-egg=自我命名项目.egg )")])])],1),e._v(" "),t("el-button",{attrs:{id:"addprojectbtn"},on:{click:e.addProject}},[e._v("添加")])],1)},staticRenderFns:[]};var j=t("VU/8")(h,b,!1,function(e){t("zbHB"),t("R+/v")},"data-v-768decec",null);r.default=j.exports},fxRn:function(e,r,t){t("+tPU"),t("zQR9"),e.exports=t("g8Ux")},g8Ux:function(e,r,t){var a=t("77Pl"),o=t("3fs2");e.exports=t("FeBl").getIterator=function(e){var r=o(e);if("function"!=typeof r)throw TypeError(e+" is not iterable!");return a(r.call(e))}},p6DB:function(e,r,t){(e.exports=t("FZ+f")(!1)).push([e.i,"\n.el-upload-dragger{\r\n  position: absolute;\r\n  left: -50px;\r\n  background-color:#f6f6f6;\r\n  width: 220px !important;\r\n  height: 100px !important;\r\n  position: relative;\n}\n.el-icon-upload{\r\n  display: none;\n}\n.el-upload__text{\r\n  padding-top: 15%\n}\n.el-upload__tip{\r\n  font-weight: bolder;\r\n  position: relative;\r\n  left: -50px;\n}\n.el-upload-list__item-name{\r\n  color:dodgerblue;\n}\n.el-upload-list{\r\n  position: relative;\r\n  left: -50px;\r\n  width: 20%;\n}\n.el-upload-list__item{\r\n  width: 200px;\n}\n#addprojectbtn{\r\n  width: 150px;\n}\r\n",""])},zbHB:function(e,r,t){var a=t("5KrN");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);t("rjj0")("309b56c9",a,!0)}});